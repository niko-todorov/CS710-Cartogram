xlab(label="Distance from Equator by Latitude") +
ylab(label="Happiness Score") +
labs(fill="Average Happiness Score",alpha="Average Population") +
theme_classic() +
scale_fill_viridis_c(option="magma",limits=c(min_score,max_score)) +
scale_alpha_manual(values = c(0.1,0.4,.7))
box_pop_plot
geom_boxplot(aes(x=lat_cat,y=score,alpha=1/log10(latitude$pop),fill="black") +
box_pop_plot <- ggplot(latitude) +
geom_boxplot(aes(x=lat_cat,y=score,fill=mean_score)) +
geom_boxplot(aes(x=lat_cat,y=score,alpha=1/log10(latitude$pop)),fill="black") +
ggtitle("Happiness vs Distance from Equator") +
xlab(label="Distance from Equator by Latitude") +
ylab(label="Happiness Score") +
labs(fill="Average Happiness Score",alpha="Average Population") +
theme_classic() +
scale_fill_viridis_c(option="magma",limits=c(min_score,max_score)) +
scale_alpha_manual(values = c(0.1,0.4,.7))
box_pop_plot <- ggplot(latitude) +
geom_boxplot(aes(x=lat_cat,y=score,fill=mean_score)) +
geom_boxplot(aes(x=lat_cat,y=score,alpha=1/log10(latitude$pop)),fill="black") +
ggtitle("Happiness vs Distance from Equator") +
xlab(label="Distance from Equator by Latitude") +
ylab(label="Happiness Score") +
labs(fill="Average Happiness Score",alpha="Average Population") +
theme_classic() +
scale_fill_viridis_c(option="magma",limits=c(min_score,max_score)) +
scale_alpha_manual(values = c(0.1,0.4,.7))
box_pop_plot <- ggplot(latitude) +
geom_boxplot(aes(x=lat_cat,y=score,fill=mean_score)) +
geom_boxplot(aes(x=lat_cat,y=score,alpha=1/log10(latitude$pop)),fill="black") +
ggtitle("Happiness vs Distance from Equator") +
xlab(label="Distance from Equator by Latitude") +
ylab(label="Happiness Score") +
labs(fill="Average Happiness Score",alpha="Average Population") +
theme_classic() +
scale_fill_viridis_c(option="magma",limits=c(min_score,max_score)) +
scale_alpha_manual(values = c(0.1,0.4,.7))
box_pop_plot
box_pop_plot <- ggplot(latitude) +
geom_boxplot(aes(x=lat_cat,y=score,fill=mean_score)) +
geom_boxplot(aes(x=lat_cat,y=score,alpha=1/log10(pop)),fill="black") +
ggtitle("Happiness vs Distance from Equator") +
xlab(label="Distance from Equator by Latitude") +
ylab(label="Happiness Score") +
labs(fill="Average Happiness Score",alpha="Average Population") +
theme_classic() +
scale_fill_viridis_c(option="magma",limits=c(min_score,max_score)) +
scale_alpha_manual(values = c(0.1,0.4,.7))
box_pop_plot
box_pop_plot <- ggplot(latitude) +
geom_boxplot(aes(x=lat_cat,y=score,fill=mean_score)) +
geom_boxplot(aes(x=lat_cat,y=score,alpha=1/log10(pop))) +
ggtitle("Happiness vs Distance from Equator") +
xlab(label="Distance from Equator by Latitude") +
ylab(label="Happiness Score") +
labs(fill="Average Happiness Score",alpha="Average Population") +
theme_classic() +
scale_fill_viridis_c(option="magma",limits=c(min_score,max_score)) +
scale_alpha_manual(values = c(0.1,0.4,.7))
box_pop_plot
box_pop_plot <- ggplot(latitude) +
geom_boxplot(aes(x=lat_cat,y=score,fill=mean_score)) +
geom_boxplot(aes(x=lat_cat,y=score,alpha=pop_cat_max),fill="black") +
ggtitle("Happiness vs Distance from Equator") +
xlab(label="Distance from Equator by Latitude") +
ylab(label="Happiness Score") +
labs(fill="Average Happiness Score",alpha="Average Population") +
theme_classic() +
scale_fill_viridis_c(option="magma",limits=c(min_score,max_score)) +
scale_alpha_manual(values = c(0.1,0.4,.7))
box_pop_plot
box_pop_plot <- ggplot(latitude) +
geom_boxplot(aes(x=lat_cat,y=score,alpha=pop_cat_max),fill="black") +
ggtitle("Happiness vs Distance from Equator") +
xlab(label="Distance from Equator by Latitude") +
ylab(label="Happiness Score") +
labs(fill="Average Happiness Score",alpha="Average Population") +
theme_classic() +
scale_fill_viridis_c(option="magma",limits=c(min_score,max_score)) +
scale_alpha_manual(values = c(0.1,0.4,.7))
box_pop_plot
latitude=subset(latitude,-c(pop_cat_max))
drop <- c("pop_cat_max")
latitude = latitude[,!(names(latitude) %in% drop)]
View(latitude)
latitude = latitude[,!(names(latitude) %in% "pop_cat_max")]
latitude$pop_cat<-factor(cut(1/log10(latitude$pop),breaks=seq(0,1,.01)))
popcat<-latitude %>% group_by(lat_cat) %>% count(pop_cat_max=pop_cat) %>% top_n(1)
latitude<-merge(latitude,popcat,by.x="lat_cat",by.y="lat_cat")
box_pop_plot <- ggplot(latitude) +
geom_boxplot(aes(x=lat_cat,y=score,alpha=pop_cat_max),fill="black") +
ggtitle("Happiness vs Distance from Equator") +
xlab(label="Distance from Equator by Latitude") +
ylab(label="Happiness Score") +
labs(fill="Average Happiness Score",alpha="Average Population") +
theme_classic() +
scale_fill_viridis_c(option="magma",limits=c(min_score,max_score)) +
scale_alpha_manual(values = c(0.1,0.4,.7))
box_pop_plot
box_pop_plot <- ggplot(latitude) +
geom_boxplot(aes(x=lat_cat,y=score,alpha=pop_cat_max),fill="black") +
ggtitle("Happiness vs Distance from Equator") +
xlab(label="Distance from Equator by Latitude") +
ylab(label="Happiness Score") +
labs(fill="Average Happiness Score",alpha="Average Population") +
theme_classic() +
scale_fill_viridis_c(option="magma",limits=c(min_score,max_score)) +
scale_alpha_manual(values = c(0.1,0.4,.7,1))
box_pop_plot
latitude = latitude[,!(names(latitude) %in% "pop_cat_max")]
latitude$pop_cat<-factor(cut(1/log10(latitude$pop),breaks=seq(0,1,.02)))
popcat<-latitude %>% group_by(lat_cat) %>% count(pop_cat_max=pop_cat) %>% top_n(1)
latitude<-merge(latitude,popcat,by.x="lat_cat",by.y="lat_cat")
box_pop_plot <- ggplot(latitude) +
geom_boxplot(aes(x=lat_cat,y=score,alpha=pop_cat_max),fill="black") +
ggtitle("Happiness vs Distance from Equator") +
xlab(label="Distance from Equator by Latitude") +
ylab(label="Happiness Score") +
labs(fill="Average Happiness Score",alpha="Average Population") +
theme_classic() +
scale_fill_viridis_c(option="magma",limits=c(min_score,max_score)) +
scale_alpha_manual(values = c(0.1,0.4,.7))
box_pop_plot
View(popcat)
popcat<-latitude %>% count(lat_cat, pop_cat) %>%slice(which.max(n))
View(popcat)
popcat<-latitude %>% group_by(lat_cat) %>% count(lat_cat, pop_cat) %>%slice(which.max(n))
View(popcat)
latitude<-merge(latitude,popcat,by.x="lat_cat",by.y="lat_cat")
latitude = latitude[,!(names(latitude) %in% "pop_cat_max")]
latitude$pop_cat<-factor(cut(1/log10(latitude$pop),breaks=seq(0,1,.02)))
popcat<-latitude %>% group_by(lat_cat) %>% count(lat_cat, pop_cat) %>%slice(which.max(n))
latitude<-merge(latitude,popcat,by.x="lat_cat",by.y="lat_cat")
box_pop_plot <- ggplot(latitude) +
geom_boxplot(aes(x=lat_cat,y=score,alpha=pop_cat_max),fill="black") +
ggtitle("Happiness vs Distance from Equator") +
xlab(label="Distance from Equator by Latitude") +
ylab(label="Happiness Score") +
labs(fill="Average Happiness Score",alpha="Average Population") +
theme_classic() +
scale_fill_viridis_c(option="magma",limits=c(min_score,max_score)) +
scale_alpha_manual(values = c(0.1,0.4,.7))
box_pop_plot
latitude = latitude[,!(names(latitude) %in% "pop_cat")]
latitude = latitude[,!(names(latitude) %in% "pop_cat.x")]
latitude = latitude[,!(names(latitude) %in% "pop_cat.y")]
latitude$pop_cat<-factor(cut(1/log10(latitude$pop),breaks=seq(0,1,.02)))
popcat<-latitude %>% group_by(lat_cat) %>% count(lat_cat, pop_cat_max=pop_cat) %>% slice(which.max(n))
latitude<-merge(latitude,popcat,by.x="lat_cat",by.y="lat_cat")
latitude = latitude[,!(names(latitude) %in% "n")]
latitude = latitude[,!(names(latitude) %in% "n,x")]
latitude = latitude[,!(names(latitude) %in% "n.x")]
latitude = latitude[,!(names(latitude) %in% "n.y")]
View(latitude)
library(ggplot2)
library(maps)
library(mapproj)
library(dplyr)
library(tidyr)
library(gridExtra)
#Read in combined happiness data (2015-2019)
data <- read.csv(file = 'data/pop-happiness.csv')
#Edit specific labels to merge with countries data set
data$Country[data$Country=="United States"] <- "USA"
data$Country[data$Country=="United Kingdom"] <- "UK"
#Set happiness score of each country to mean of that country over all years
world_happiness<-data %>% group_by(Country,Region) %>% summarise(Score=mean(HappinessScore),Population=mean(Population))
#Read in country data
countries<-map_data("world")
#Merge countries and happiness data
happiness_map<-merge(countries,world_happiness,by.x="region",by.y="Country",all=TRUE)
happiness_map<-arrange(happiness_map,group,order)
#MAP
#Happiness by country map
map_plot<-ggplot(happiness_map,aes(x=long,y=lat,group=group,fill=Score)) +
coord_quickmap() +
geom_polygon() +
ggtitle("Happiness by Country (2015-2019)") +
labs(fill="Happiness Score") +
theme_void() +
scale_fill_viridis_c(option="magma")
map_plot
min_pop<-min((happiness_map %>% drop_na)$Population)
#Happiness by country map, brightness by population
happiness_map$Population[is.na(happiness_map$Population)] <- min_pop-1
happiness_map$pop_cat<-factor(cut(1/log10(happiness_map$Population),breaks=seq(0,1,.04)),labels=c("Large","Medium","Small"))
map_pop_plot<-ggplot(happiness_map) +
coord_quickmap() +
geom_polygon(aes(x=long, y=lat, group=group, fill=Score)) +
geom_polygon(aes(x=long, y=lat, group=group, alpha=pop_cat)) +
ggtitle("Happiness by Country (2015-2019)") +
labs(fill="Happiness Score",alpha="Population") +
theme_void() +
scale_fill_viridis_c(option="magma") +
scale_alpha_manual(values = c(0.1,0.4,.7))
#Get average absolute value of latitude (distance from equator) for each country with the average happiness score
latitude<-happiness_map %>% group_by(region) %>% summarise(score=mean(Score),lat=mean(abs(lat)),pop=mean(Population)) %>% drop_na()
min_score<-min(latitude$score)
max_score<-max(latitude$score)
latitude$lat_cat<-factor(cut(latitude$lat,breaks=seq(0,70,5),labels=seq(0,65,5)))
latitude<-latitude %>% group_by(lat_cat) %>% mutate(mean_score=mean(score))
box_plot <- ggplot(latitude,aes(x=lat_cat,y=score,fill=mean_score)) +
geom_boxplot() +
ggtitle("Happiness vs Distance from Equator") +
xlab(label="Distance from Equator by Latitude") +
ylab(label="Happiness Score") +
labs(fill="Average Happiness Score") +
theme_classic() +
scale_fill_viridis_c(option="magma",limits=c(min_score,max_score))
box_plot
grid.arrange(map_plot, box_plot, nrow=2)
#latitude = latitude[,!(names(latitude) %in% "n.y")]
latitude$pop_cat<-factor(cut(1/log10(latitude$pop),breaks=seq(0,1,.02)))
popcat<-latitude %>% group_by(lat_cat) %>% count(lat_cat, pop_cat_max=pop_cat) %>% slice(which.max(n))
latitude<-merge(latitude,popcat,by.x="lat_cat",by.y="lat_cat")
box_pop_plot <- ggplot(latitude) +
geom_boxplot(aes(x=lat_cat,y=score,alpha=pop_cat_max),fill="black") +
ggtitle("Happiness vs Distance from Equator") +
xlab(label="Distance from Equator by Latitude") +
ylab(label="Happiness Score") +
labs(fill="Average Happiness Score",alpha="Average Population") +
theme_classic() +
scale_fill_viridis_c(option="magma",limits=c(min_score,max_score)) +
scale_alpha_manual(values = c(0.1,0.4,.7))
box_pop_plot
grid.arrange(map_pop_plot, box_pop_plot, nrow=2)
#latitude = latitude[,!(names(latitude) %in% "n.y")]
latitude$pop_cat<-factor(cut(1/log10(latitude$pop),breaks=seq(0,1,.01)))
popcat<-latitude %>% group_by(lat_cat) %>% count(lat_cat, pop_cat_max=pop_cat) %>% slice(which.max(n))
latitude<-merge(latitude,popcat,by.x="lat_cat",by.y="lat_cat")
box_pop_plot <- ggplot(latitude) +
geom_boxplot(aes(x=lat_cat,y=score,alpha=pop_cat_max),fill="black") +
ggtitle("Happiness vs Distance from Equator") +
xlab(label="Distance from Equator by Latitude") +
ylab(label="Happiness Score") +
labs(fill="Average Happiness Score",alpha="Average Population") +
theme_classic() +
scale_fill_viridis_c(option="magma",limits=c(min_score,max_score)) +
scale_alpha_manual(values = c(0.1,0.4,.7))
box_pop_plot
latitude = latitude[,!(names(latitude) %in% "n.y")]
latitude = latitude[,!(names(latitude) %in% "n.x")]
latitude = latitude[,!(names(latitude) %in% "pop_cat_max.x")]
latitude = latitude[,!(names(latitude) %in% "pop_cat_max.y")]
latitude$pop_cat<-factor(cut(1/log10(latitude$pop),breaks=seq(0,1,.01)))
popcat<-latitude %>% group_by(lat_cat) %>% count(lat_cat, pop_cat_max=pop_cat) %>% slice(which.max(n))
latitude<-merge(latitude,popcat,by.x="lat_cat",by.y="lat_cat")
box_pop_plot <- ggplot(latitude) +
geom_boxplot(aes(x=lat_cat,y=score,alpha=pop_cat_max),fill="black") +
ggtitle("Happiness vs Distance from Equator") +
xlab(label="Distance from Equator by Latitude") +
ylab(label="Happiness Score") +
labs(fill="Average Happiness Score",alpha="Average Population") +
theme_classic() +
scale_fill_viridis_c(option="magma",limits=c(min_score,max_score)) +
scale_alpha_manual(values = c(0.1,0.4,.7))
box_pop_plot
box_pop_plot <- ggplot(latitude) +
geom_boxplot(aes(x=lat_cat,y=score,fill=mean_score)) +
geom_boxplot(aes(x=lat_cat,y=score,alpha=pop_cat_max),fill="black") +
ggtitle("Happiness vs Distance from Equator") +
xlab(label="Distance from Equator by Latitude") +
ylab(label="Happiness Score") +
labs(fill="Average Happiness Score",alpha="Average Population") +
theme_classic() +
scale_fill_viridis_c(option="magma",limits=c(min_score,max_score)) +
scale_alpha_manual(values = c(0.1,0.4,.7))
box_pop_plot
grid.arrange(map_pop_plot, box_pop_plot, nrow=2)
library(readr)
PopulationMod <- read_csv("data/PopulationMod.csv")
View(PopulationMod)
library(readr)
pop_happiness <- read_csv("data/pop-happiness.csv")
View(pop_happiness)
library(maptools)
data(wrld_simpl)
afr=wrld_simpl[wrld_simpl$REGION==2,]
install.packages("maptools")
library(maptools)
gpclibPermit()
gpclibPermit(TRUE)
library(maptools)
gpclibPermit()
data(wrld_simpl)
afr=wrld_simpl[wrld_simpl$REGION==2,]
plot(afr)
afr_cartogram <- cartogram(afr, "POP2005", itermax=5)
plot(afr_cartogram)
install.packages("cartogram")
library(cartogram)
afr_cartogram <- cartogram(afr, "POP2005", itermax=5)
plot(afr_cartogram)
afr_cartogram <- cartogram_cont(afr, "POP2005", itermax=5)
afr=wrld_simpl[wrld_simpl$REGION==2,]
afr_cartogram <- cartogram_cont(afr, "POP2005", itermax=5)
install.packages("rgeos")
library(rgeos)
install.packages("sp")
install.packages("sp")
library(sp)
afr_cartogram <- cartogram_cont(afr, "POP2005", itermax=5)
plot(afr_cartogram)
install.packages("sp")
install.packages("sp")
install.packages("sp")
install.packages("sp")
install.packages("cartogram")
install.packages("rgeos")
install.packages("sp")
library(sp)
library(rgeos)
library(cartogram)
afr_cartogram <- cartogram_cont(afr, "POP2005", itermax=5)
afr_cartogram <- cartogram(afr, "POP2005", itermax=5)
install.packages("cartogram")
library(ggplot2)
library(sp)
library(spatial)
library(cartogram)
install.packages("sp")
detach("package:cartogram", unload = TRUE)
detach("package:ggplot2", unload = TRUE)
detach("package:graphics", unload = TRUE)
library(graphics)
library(rgeos)
detach("package:spatial", unload = TRUE)
detach("package:sp", unload = TRUE)
detach("package:rgeos", unload = TRUE)
library(viridis)
detach("package:viridis", unload = TRUE)
detach("package:viridisLite", unload = TRUE)
library(maps)
detach("package:maps", unload = TRUE)
library(maptools)
detach("package:maptools", unload = TRUE)
afr_cartogram <- cartogram_cont(afr, "POP2005", itermax=5)
library(cartogram)
afr_cartogram <- cartogram_cont(afr, "POP2005", itermax=5)
afr_cartogram <- cartogram(afr, "POP2005", itermax=5)
library(maptools)
gpclibPermit()
data(wrld_simpl)
afr=wrld_simpl[wrld_simpl$REGION==2,]
plot(afr)
install.packages("maptools")
install.packages("maptools")
library(maptools)
gpclibPermit()
#install.packages("maptools")
library(maptools)
data(wrld_simpl)
afr=wrld_simpl[wrld_simpl$REGION==2,]
plot(afr)
View(afr)
View(afr)
View(afr)
View(afr)
library(maptools)
library(cartogram)
library(rgdal)
install.packages("rgdal")
library(rgdal)
install.packages("geos")
library(rgdal)
data(wrld_simpl)
# Remove uninhabited regions
afr <- spTransform(wrld_simpl[wrld_simpl$REGION==2 & wrld_simpl$POP2005 > 0,],
CRS("+init=epsg:3395"))
# Create cartogram
afr_carto <- cartogram_cont(afr, "POP2005", 3)
# Plot
par(mfcol=c(1,2))
plot(afr, main="original")
plot(afr_carto, main="distorted (sp)")
# Same with sf objects
library(sf)
install.packages("sf")
afr_sf = st_as_sf(afr)
afr_sf_carto <- cartogram_cont(afr_sf, "POP2005", 3)
# Plot
par(mfcol=c(1,3))
plot(afr, main="original")
plot(afr_carto, main="distorted (sp)")
plot(st_geometry(afr_sf_carto), main="distorted (sf)")
library(maptools)
library(cartogram)
library(rgdal)
data(wrld_simpl)
# Remove uninhabited regions
afr <- spTransform(wrld_simpl[wrld_simpl$REGION==2 & wrld_simpl$POP2005 > 0,],
CRS("+init=epsg:3395"))
# Create cartogram
afr_carto <- cartogram_dorling(afr, "POP2005")
# Plot
par(mfcol=c(1,2))
plot(afr, main="original")
plot(afr, main="distorted (sp)")
plot(afr_carto, col = "red", add=TRUE)
# Same with sf objects
library(sf)
afr_sf = st_as_sf(afr)
afr_sf_carto <- cartogram_dorling(afr_sf, "POP2005")
# Plot
par(mfcol=c(1,3))
plot(afr, main="original")
plot(afr_carto, main="distorted (sp)")
plot(st_geometry(afr_sf_carto), main="distorted (sf)")
library(maptools)
library(cartogram)
library(rgdal)
data(wrld_simpl)
# Remove uninhabited regions
afr <- spTransform(wrld_simpl[wrld_simpl$REGION==2 & wrld_simpl$POP2005 > 0,],
CRS("+init=epsg:3395"))
# Create cartogram
afr_nc <- cartogram_ncont(afr, "POP2005")
# Plot
plot(afr)
plot(afr_nc, add = TRUE, col = 'red')
# Same with sf objects
library(sf)
afr_sf = st_as_sf(afr)
afr_sf_nc <- cartogram_ncont(afr_sf, "POP2005")
plot(st_geometry(afr_sf))
plot(st_geometry(afr_sf_nc), add = TRUE, col = 'red')
packages<-c("ggplot2","tibble","dplyr","tidyr","viridis","mapproj","purrr")
install.packages(setdiff(packages, rownames(installed.packages())))
library(ggplot2)
library(dplyr)
library(tidyr)
library(viridis)
library(maps)
library(mapproj)
library(tibble)
library(purrr)
library(readr)
library(ggalt)
happiness <- read_csv("data/happinessdata.csv")
mid <- mean(happiness$Year)
ggplot(happiness,aes(x=Economy,y=HappinessScore,color=Year))+
geom_point() +
scale_color_gradient2(midpoint=mid,low="blue",mid="white",
high="red",space="Lab")
ggplot(data <- happiness, mapping <- aes(x<-Health, y<-as.factor(Region), fill<-as.factor(Year))) + geom_violin(trim=TRUE) + geom_boxplot(width=0.1) # geom_point() # geom_contour
library(maptools)
View(wrld_simpl)
library(maptools)
library(cartogram)
library(rgdal)
data(wrld_simpl)
# Remove uninhabited regions
wld <- spTransform(wrld_simpl[wrld_simpl$REGION & wrld_simpl$POP2005 > 0,],
CRS("+init=epsg:3395"))
# Create cartogram
wld_carto <- cartogram_cont(wld, "POP2005", 3)
# Plot
par(mfcol=c(1,2))
plot(wld, main="original")
plot(wld_carto, main="distorted (sp)")
# Same with sf objects
library(sf)
wld_sf = st_as_sf(wld)
wld_sf_carto <- cartogram_cont(wld_sf, "POP2005", 3)
# Plot
par(mfcol=c(1,3))
plot(wld, main="original")
plot(wld_carto, main="distorted (sp)")
plot(st_geometry(wld_sf_carto), main="distorted (sf)")
source('C:/projects/GitHub/chapman/Workshop1Group3/src/cartogram.R')
library(maptools)
library(cartogram)
library(rgdal)
data(wrld_simpl)
# Remove uninhabited regions
wld <- spTransform(wrld_simpl[wrld_simpl$REGION & wrld_simpl$POP2005 > 0,],
CRS("+init=epsg:3395"))
# Create cartogram
wld_nc <- cartogram_ncont(afr, "POP2005")
# Plot
plot(wld)
plot(wlc_nc, add = TRUE, col = 'red')
# Same with sf objects
library(sf)
wld_sf = st_as_sf(wld)
wld_sf_nc <- cartogram_ncont(wld_sf, "POP2005")
plot(st_geometry(wld_sf))
plot(st_geometry(wld_sf_nc), add = TRUE, col = 'red')
library(maptools)
library(cartogram)
library(rgdal)
data(wrld_simpl)
# Remove uninhabited regions
wld <- spTransform(wrld_simpl[wrld_simpl$REGION & wrld_simpl$POP2005 > 0,],
CRS("+init=epsg:3395"))
# Create cartogram
wld_carto <- cartogram_dorling(wld, "POP2005")
# Plot
par(mfcol=c(1,2))
plot(wld, main="original")
plot(wld, main="distorted (sp)")
plot(wld_carto, col = "red", add=TRUE)
# Same with sf objects
library(sf)
wld_sf = st_as_sf(wld)
wld_sf_carto <- cartogram_dorling(wld_sf, "POP2005")
# Plot
par(mfcol=c(1,3))
plot(wld, main="original")
plot(wld_carto, main="distorted (sp)")
plot(st_geometry(wld_sf_carto), main="distorted (pop)")
